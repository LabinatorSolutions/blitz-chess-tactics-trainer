@use "../../../assets/stylesheets/_variables" as vars
@use "../../components/puzzle_player/style" as puzzle-player

body[data-controller=puzzles][data-action=show]
  $board-size: 496px

  margin: 0 auto 50px

  .board-area-container
    display: flex
    align-items: center
    flex-direction: column
    position: relative
    z-index: 1

  .board-area
    width: $board-size
    height: $board-size
    min-width: 256px
    min-height: 256px
    position: relative

  .chessground-board
    width: 100%
    height: 100%

  .container
    display: flex
    align-items: center

  .invisible
    transition: 0.1s ease

  .below-board
    display: none

  .board-section
    display: flex
    flex-direction: column
    align-items: center

    .above-board
      height: 80px // Give proper height to prevent scrunching
      position: relative
      display: flex
      flex-direction: column
      justify-content: center
      align-items: center
      margin-bottom: 20px

      .instructions
        font-weight: bold
        text-shadow: 0 0 8px rgba(0,0,0,0.9)
        font-size: 25px
        text-align: center
        margin: 0 !important
        position: static !important
        top: auto !important
        width: auto !important
        transition: all 0.35s ease-out

        &.smaller
          font-size: 22px

      .puzzle-hint
        text-align: center
        margin: 0 !important
        position: static !important
        top: auto !important
        width: auto !important
        transition: opacity 0.15s ease
        z-index: 10

        .hint-trigger
          background: #565656
          padding: 6px 14px 5px
          color: white
          display: inline-block
          border-radius: 2px
          font-size: 12px
          transition: opacity 0.08s ease

          &:hover
            cursor: pointer
            background: #676767

          &.invisible
            pointer-events: none

        .move
          font-size: 14px
          color: rgba(255,255,255,0.5)
          height: 0

      .move-status
        opacity: 1
        font-family: vars.$combo-indicator-font
        font-size: 32px
        text-align: center
        text-transform: uppercase
        transform: scale3d(1,1,1)
        transition: opacity 0.02s ease
        margin: 0 !important
        position: static !important
        top: auto !important
        width: auto !important

        &.fade-out
          opacity: 0
          transform: scale3d(0.92,0.92,1)
          transition: opacity 0.9s ease-out 0.2s, transform 0.05s ease-in-out

        .perfect
          color: #4CAF50
          font-weight: 600
          letter-spacing: 3px
          font-size: 40px

        .great
          color: #8BC34A
          font-weight: 600
          letter-spacing: 3px
          font-size: 38px

        .good
          color: #CDDC39
          font-weight: 600
          letter-spacing: 3px
          font-size: 38px

        .almost
          color: #FF9800
          position: relative
          top: 12px

        .fail
          color: #F44336
          position: relative
          top: 12px

      .combo-counter
        text-align: center
        font-family: vars.$combo-indicator-font
        transition: opacity 0.25s ease
        margin: 0 !important
        position: static !important
        top: auto !important
        width: auto !important

        .counter
          display: inline-block
          font-size: 24px
          margin-right: 5px

          &.large
            font-size: 52px

          &.on-fire
            font-size: 70px

          &.emphasis
            transform: scale3d(1.25, 1.25, 1)

        .combo-text
          position: relative
          text-transform: uppercase
          font-size: 14px
          top: -2px

  .puzzle-info-section
    margin: 40px auto 0
    width: 100%
    max-width: 600px

    h2 
      margin-bottom: 15px
      text-align: center

    .description 
      font-size: 14px
      line-height: 21px
      opacity: 0.5

    .ext-link
      font-size: 14px
      color: rgba(255, 255, 255, 0.6)
      display: block
      padding: 3px 0
      text-align: center

      &:hover
        color: rgba(255, 255, 255, 0.8)

    .fen
      margin: 10px 0
      width: 100%

    .puzzle-info
      margin-top: 20px

      .metadata
        font-size: 14px
        opacity: 0.7
        margin-top: 20px
        line-height: 1.3em
        width: 100%

        td
          padding-right: 25px

    .report-puzzle
      margin-top: 40px

    .puzzle-report-form
      margin-top: 25px
      display: none

      .dark-button
        margin-top: 8px
        margin-right: 8px

      textarea
        padding: 5px 10px

    .puzzle-report-status
      margin-top: 30px

    .puzzle-report-message
      width: 100%

  .actions 
    margin-top: 30px
    text-align: center

    .button 
      font-size: 16px
      padding: 8px 20px
      border: 0
      border-radius: 3px
      background: black
      color: white
      display: inline-block
      font-family: vars.$main-font
      line-height: 22px
      text-decoration: none
      transition: opacity 0.25s ease
      margin: 0 5px

      &:hover 
        background: #51B7FF
        cursor: pointer

      &:disabled
        opacity: 0.6
        cursor: not-allowed
        background: #666

      &.show-solution
        background: #007bff
        min-width: 140px  // Fixed width to prevent resizing
        text-align: center

        &:hover:not(:disabled)
          background: #0056b3
