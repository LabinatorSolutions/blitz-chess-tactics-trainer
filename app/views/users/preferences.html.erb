<div class="container">
  <div class="preferences-page">
    <h2>Preferences</h2>

    <% if flash[:alert].present? %>
      <div class="alert"><%= flash[:alert] %></div>
    <% end %>
    <% if flash[:notice].present? %>
      <div class="alert-notice"><%= flash[:notice] %></div>
    <% end %>

    <div class="section">
      <div class="customize-board-row">
        <div class="customize-copy">
          <h3>Customize board</h3>
          <p>Change the look and feel of your chessboard.</p>
          <p><a class="blue-button" href="/customize">Customize board</a></p>
        </div>
        <div class="board-preview">
          <% if current_user&.user_chessboard %>
            <style type="text/css"><%= current_user.user_chessboard.to_css %></style>
          <% end %>
          <%= render partial: "static/snippets/miniboard", locals: {
                fen: "rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",
                flip: false
              } %>
        </div>
      </div>
    </div>

    <hr/>

    <div class="section">
      <h3>Change password</h3>
      <%= form_for current_user, url: registration_path(:user), html: { method: :put } do |f| %>
        <div class="field" style="max-width: 340px">
          <label for="user_current_password">Current password</label>
          <%= f.password_field :current_password, required: true, autocomplete: 'current-password' %>
        </div>
        <div class="field" style="max-width: 340px">
          <label for="user_password">New password</label>
          <%= f.password_field :password, required: true, autocomplete: 'new-password' %>
        </div>
        <div class="field" style="max-width: 340px">
          <label for="user_password_confirmation">Confirm new password</label>
          <%= f.password_field :password_confirmation, required: true, autocomplete: 'new-password' %>
        </div>
        <%= f.submit 'Change password', class: 'blue-button' %>
      <% end %>
    </div>

    <hr/>

    <div class="section">
      <h3>Change email</h3>
      <p>Optional. Emails are only sent to help reset your password if you forget it.</p>
      <%= form_for current_user, url: registration_path(:user), html: { method: :put } do |f| %>
        <div class="field" style="max-width: 340px">
          <label for="user_email">Email</label>
          <%= f.email_field :email, value: current_user.email, autocomplete: 'email' %>
        </div>
        <div class="field" style="max-width: 340px">
          <label for="user_current_password">Confirm your password</label>
          <%= f.password_field :current_password, required: true, autocomplete: 'current-password' %>
        </div>
        <%= f.submit 'Change email', class: 'blue-button' %>
      <% end %>
    </div>

    <hr/>

    <div class="section" style="margin-top: 120px">
      <h3>Delete account</h3>
      <p>This will permanently delete your account and cannot be undone.</p>
      <%= form_tag '/account', method: :delete do %>
        <div class="field" style="max-width: 240px">
          <label for="current_password">Confirm your password</label>
          <%= password_field_tag :current_password, nil, required: true, autocomplete: 'current-password' %>
        </div>
        <%= submit_tag 'Delete my account', class: 'dark-button', onclick: "return confirm('Are you sure you want to delete your account? This cannot be undone.')" %>
      <% end %>
    </div>
  </div>
</div>
